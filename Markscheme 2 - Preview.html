<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <link rel="stylesheet" type="text/css" href="https://martinbateman.github.io/style.css">
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
  <script id="odauth" src="https://martinbateman.github.io/odauth.js"></script>
  
  <link rel="icon" href="https://d.sfx-df.ms/images/favicon.ico" type="image/x-icon">
  <link rel="mask-icon" href="https://d.sfx-df.ms/images/mask_icon.svg" color="#094AB2">
<script>
    function signInToOneDrive()
    {
      var appInfo = {
        "clientId": "da55778d-4c93-4a5d-9ac9-7e3d95c531ef",
        "redirectUri": "https://martinbateman.github.io/callback.html",
        "scopes": "files.readwrite.all",
        "authServiceUri": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize"
      };
      provideAppInfo(appInfo);

      var baseUrl = getQueryVariable("baseUrl")
      msGraphApiRoot = (baseUrl) ? baseUrl : "https://graph.microsoft.com/v1.0/me";

      challengeForAuth();

      saveToCookie( { "apiRoot": msGraphApiRoot, "signedin": true } );
      return false;
    }

    function showCustomLoginButton(show)
    {
      var loginButton = document.getElementById("od-login");
      loginButton.style.display = show ? "block" : "none";

      var logoutButton = document.getElementById("od-logoff");
      logoutButton.style.display = show ? "none" : "block";
    }
    function saveToCookie(obj)
    {
      var expiration = new Date();
      expiration.setTime(expiration.getTime() + 3600 * 1000);
      var data = JSON.stringify(obj);
      var cookie = "odexplorer=" + data +"; path=/; expires=" + expiration.toUTCString();

      if (document.location.protocol.toLowerCase() == "https") {
        cookie = cookie + ";secure";
      }
      document.cookie = cookie;
    }
    function loadFromCookie()
    {
      var cookies = document.cookie;
      var name = "odexplorer=";
      var start = cookies.indexOf(name);
      if (start >= 0) {
        start += name.length;
        var end = cookies.indexOf(';', start);
        if (end < 0) {
          end = cookies.length;
        }
        else {
          postCookie = cookies.substring(end);
        }

        var value = cookies.substring(start, end);
        return JSON.parse(value);
      }

      return "";
    }
    function signOut()
    {
      logoutOfAuth();
      saveToCookie( { "apiRoot": msGraphApiRoot, "signedin": false } );
      $('#od-breadcrumb').empty();
      $('#od-items').empty();
      $('#od-json').empty();
      location.reload();
      clearInterval ();
    }
    function getQueryVariable(variable)
    {
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
     }

  var globalToken = "";
  var moduleCode = "CO2516";
  var assignmentNumber = "2";
  var saved = 1;
  var itemID = "";
  var maxX = 0;
  var maxX = 0;
  var settingDir = "appData";
  var fileName = "/" + settingDir + "/" + moduleCode + "-assignment-" + assignmentNumber + ".json"; 
  var pageTitle = "CO2516 Assignment 2 - Grade estimator";
  </script>
</head>
<body>
 <div id="od-site">
    <div id="od-commands">
      <div id="od-login" style="display: block;">
        <a href="#" onclick="signInToOneDrive()">Sign in to OneDrive</a>&nbsp;&nbsp;
      </div>
      <div id="od-logoff" style="display: none;">
        <a href="#" onclick="signOut()">Sign Out</a>
      </div>
    </div>
    <div id="od-title">CO2516 Assignment 2 - Grade estimator</div>
  </div>

  <div id="od-loading"></div>
  <div id="od-breadcrumb"></div>
  <div id="od-content">
<p>
This allows you to estimate your mark based on which critria you have completed. You should note that you are
not guaranteed to get the mark you work out using this tool.
</p>
<p>
This page is experimental. There are probably bugs or at least weird things. If you find a bug or a weird thing could you let me know.
</p>
<table border="1">
<tbody><tr>
  <td></td>
  <td>Fail(20)</td>
  <td>3(40)</td>
  <td>2i(50)</td>
  <td>2ii(60)</td>
  <td>First(70)</td>
  <td>80+(80)</td>

</tr>
<tr>
  <td>AD (20)<br> Base level configuration of the network.</td>
  
  <td id="0-0" onclick="javascript:clicked(0, 0)" name="5">Single domain controller created.
DNS configured to relay to 8.8.8.8.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 20)/ 80 * 100;
var target = document.getElementById ("0-0");
target.setAttribute ("name", worth);
maxX = 0;
maxY = 0;
</script>

  
  <td id="1-0" onclick="javascript:clicked(1, 0)" name="10">PDC and BDC created and connected together.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 40)/ 80 * 100;
var target = document.getElementById ("1-0");
target.setAttribute ("name", worth);
maxX = 1;
maxY = 0;
</script>

  
  <td id="2-0" onclick="javascript:clicked(2, 0)" name="12.5">DHCP configured. All servers are 'hardcoded' within the DHCP server.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 50)/ 80 * 100;
var target = document.getElementById ("2-0");
target.setAttribute ("name", worth);
maxX = 2;
maxY = 0;
</script>

  
  <td id="3-0" onclick="javascript:clicked(3, 0)" name="15">User groups for pupils, teachers, administrative staff and system administrators. Appropriate limits applied to each group.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 60)/ 80 * 100;
var target = document.getElementById ("3-0");
target.setAttribute ("name", worth);
maxX = 3;
maxY = 0;
</script>

  
  <td id="4-0" onclick="javascript:clicked(4, 0)" name="17.5">Roaming profiles setup. Home directory stored on network drive.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 70)/ 80 * 100;
var target = document.getElementById ("4-0");
target.setAttribute ("name", worth);
maxX = 4;
maxY = 0;
</script>

  
  <td id="5-0" onclick="javascript:clicked(5, 0)" name="20">Import users script created in Python.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 80)/ 80 * 100;
var target = document.getElementById ("5-0");
target.setAttribute ("name", worth);
maxX = 5;
maxY = 0;
</script>

  
</tr>
<tr>
  <td>Internet (20)<br> External access to the Internet.</td>
  
  <td id="0-1" onclick="javascript:clicked(0, 1)" name="5">Full access to the Internet via something like NAT.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 20)/ 80 * 100;
var target = document.getElementById ("0-1");
target.setAttribute ("name", worth);
maxX = 0;
maxY = 1;
</script>

  
  <td id="1-1" onclick="javascript:clicked(1, 1)" name="10">Internet access allowed only via a web proxy.

Exchange server setup for all staff.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 40)/ 80 * 100;
var target = document.getElementById ("1-1");
target.setAttribute ("name", worth);
maxX = 1;
maxY = 1;
</script>

  
  <td id="2-1" onclick="javascript:clicked(2, 1)" name="12.5">Web filtering enabled for all users. Content limited so that it is safe fro pupils of the primary school.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 50)/ 80 * 100;
var target = document.getElementById ("2-1");
target.setAttribute ("name", worth);
maxX = 2;
maxY = 1;
</script>

  
  <td id="3-1" onclick="javascript:clicked(3, 1)" name="15">Web filtering individual for each user class. For pupils content is filtered via a whitelist. For all other users the web access is filtered via a blacklist.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 60)/ 80 * 100;
var target = document.getElementById ("3-1");
target.setAttribute ("name", worth);
maxX = 3;
maxY = 1;
</script>

  
  <td id="4-1" onclick="javascript:clicked(4, 1)" name="17.5">Web filtering software authenticates the users to ensure the they cannot get around the content filtering.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 70)/ 80 * 100;
var target = document.getElementById ("4-1");
target.setAttribute ("name", worth);
maxX = 4;
maxY = 1;
</script>

  
  <td id="5-1" onclick="javascript:clicked(5, 1)" name="20">Deep packet inspection using an ICAP server to limit access based on keywords.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 80)/ 80 * 100;
var target = document.getElementById ("5-1");
target.setAttribute ("name", worth);
maxX = 5;
maxY = 1;
</script>

  
</tr>
<tr>
  <td>Deployment (20)<br> Operating system and application deployment.</td>
  
  <td id="0-2" onclick="javascript:clicked(0, 2)" name="5">SCCM installed but not functional.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 20)/ 80 * 100;
var target = document.getElementById ("0-2");
target.setAttribute ("name", worth);
maxX = 0;
maxY = 2;
</script>

  
  <td id="1-2" onclick="javascript:clicked(1, 2)" name="10">Application deployment available via Active Directory. Applications to be deployed are Chrome, Libre Office and Scratch 1.4.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 40)/ 80 * 100;
var target = document.getElementById ("1-2");
target.setAttribute ("name", worth);
maxX = 1;
maxY = 2;
</script>

  
  <td id="2-2" onclick="javascript:clicked(2, 2)" name="12.5">Applications that can be deployed depend on the user group.
Admin staff - Libre Office.
Pupils - Scratch 1.4, Libre Office
Teacher - Scratch, Chrome, Libre Office</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 50)/ 80 * 100;
var target = document.getElementById ("2-2");
target.setAttribute ("name", worth);
maxX = 2;
maxY = 2;
</script>

  
  <td id="3-2" onclick="javascript:clicked(3, 2)" name="15">All pupil machines are deployable via PXE. Machine should join the Domain automatically.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 60)/ 80 * 100;
var target = document.getElementById ("3-2");
target.setAttribute ("name", worth);
maxX = 3;
maxY = 2;
</script>

  
  <td id="4-2" onclick="javascript:clicked(4, 2)" name="17.5">All machines are deployable via PXE.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 70)/ 80 * 100;
var target = document.getElementById ("4-2");
target.setAttribute ("name", worth);
maxX = 4;
maxY = 2;
</script>

  
  <td id="5-2" onclick="javascript:clicked(5, 2)" name="20">Machine images are only deployable to the appropriate physical machine.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 80)/ 80 * 100;
var target = document.getElementById ("5-2");
target.setAttribute ("name", worth);
maxX = 5;
maxY = 2;
</script>

  
</tr>
<tr>
  <td>Monitoring (20)<br> Desktop and server monitoring.</td>
  
  <td id="0-3" onclick="javascript:clicked(0, 3)" name="5">Nagios XI deployed but not really usable.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 20)/ 80 * 100;
var target = document.getElementById ("0-3");
target.setAttribute ("name", worth);
maxX = 0;
maxY = 3;
</script>

  
  <td id="1-3" onclick="javascript:clicked(1, 3)" name="10">All servers monitoring to ensure they are alive. Disk space monitored on servers. If 80 percent full the system should issue a warning. If 90 percent full the system should issue an alert.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 40)/ 80 * 100;
var target = document.getElementById ("1-3");
target.setAttribute ("name", worth);
maxX = 1;
maxY = 3;
</script>

  
  <td id="2-3" onclick="javascript:clicked(2, 3)" name="12.5">Test to ensure that the PDC and BDC services are running.
Test that the DNS and DHCP are running.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 50)/ 80 * 100;
var target = document.getElementById ("2-3");
target.setAttribute ("name", worth);
maxX = 2;
maxY = 3;
</script>

  
  <td id="3-3" onclick="javascript:clicked(3, 3)" name="15">Log on to all machines are logged. Username, machine and timestamp saved.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 60)/ 80 * 100;
var target = document.getElementById ("3-3");
target.setAttribute ("name", worth);
maxX = 3;
maxY = 3;
</script>

  
  <td id="4-3" onclick="javascript:clicked(4, 3)" name="17.5">Only Administrator can log onto the Network Monitoring system.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 70)/ 80 * 100;
var target = document.getElementById ("4-3");
target.setAttribute ("name", worth);
maxX = 4;
maxY = 3;
</script>

  
  <td id="5-3" onclick="javascript:clicked(5, 3)" name="20">Web access URLs are logged and timestamped available in the network monitor.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 80)/ 80 * 100;
var target = document.getElementById ("5-3");
target.setAttribute ("name", worth);
maxX = 5;
maxY = 3;
</script>

  
</tr>
<tr>
  <td>Extras (20)<br> </td>
  
  <td id="0-4" onclick="javascript:clicked(0, 4)" name="5">Partial attempt of one or more of the extra items.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 20)/ 80 * 100;
var target = document.getElementById ("0-4");
target.setAttribute ("name", worth);
maxX = 0;
maxY = 4;
</script>

  
  <td id="1-4" onclick="javascript:clicked(1, 4)" name="10">Daily backup of servers configured to a machine within the network.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 40)/ 80 * 100;
var target = document.getElementById ("1-4");
target.setAttribute ("name", worth);
maxX = 1;
maxY = 4;
</script>

  
  <td id="2-4" onclick="javascript:clicked(2, 4)" name="12.5">VPN configured to an external source. Daily backup is over the VPN.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 50)/ 80 * 100;
var target = document.getElementById ("2-4");
target.setAttribute ("name", worth);
maxX = 2;
maxY = 4;
</script>

  
  <td id="3-4" onclick="javascript:clicked(3, 4)" name="15">RDP configured for all desktop computers for administration within the network. Only usable by the system administrator.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 60)/ 80 * 100;
var target = document.getElementById ("3-4");
target.setAttribute ("name", worth);
maxX = 3;
maxY = 4;
</script>

  
  <td id="4-4" onclick="javascript:clicked(4, 4)" name="17.5">Per teacher VPN enabled. to allow teachers access to network drives and resources from outside of the school.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 70)/ 80 * 100;
var target = document.getElementById ("4-4");
target.setAttribute ("name", worth);
maxX = 4;
maxY = 4;
</script>

  
  <td id="5-4" onclick="javascript:clicked(5, 4)" name="20">RDP on the teacher computers which allows the teachers to access and run applications from their desktop at home. Pupil accounts should not work via RDP.</td>

<script>
// it was easier to set this in JavaScript rather than set it via the HTML generator
// the name of the cell is its worth
var worth = ((20/100) * 80)/ 80 * 100;
var target = document.getElementById ("5-4");
target.setAttribute ("name", worth);
maxX = 5;
maxY = 4;
</script>

  
</tr>

</tbody></table>
<br>
<div style="display: inline-block">Estimated Total: </div><div style="display: inline-block" id="total">0</div>

<script>

var total = 0;

function gradeMap (mark){

  var allowedGrades = [0, 10, 25, 30, 35, 42, 45, 48, 52, 55, 58, 62, 65, 68, 74, 81, 89, 96, 100];


  bestFit = 0;
  bestDistance = 100;
  for (i =0; i < allowedGrades.length; i ++) {
    var distance = Math.abs (mark - allowedGrades[i]);

    if (distance < bestDistance) {
      bestFit = i;
      bestDistance = distance;
    }
  }
  return (""+allowedGrades[bestFit]);
}

function clicked (cellIDX, cellIDY){

var x = 0;
var found = true;
// remove coloured backgrounds
while (found == true){
    var parent = document.getElementById (x+"-"+cellIDY);
    
    if (parent != null) {
      if (x != cellIDX) { // skip the cell that was clicked
                          // so we know if the user has deselected an option
        if (parent.getAttribute ("style") == "background-color: orange") {
          parent.setAttribute ("style", "background-color: white");
          total = total - Math.round(Number(parent.getAttribute ("name")));
        }
      }
    x = x +1;    
  } else {
    found = false;
  }
  if (globalToken != ""){
    saved = 0;
    document.getElementById("od-title").innerHTML = pageTitle + " (not saved)";
  }
}

// set/remove colour background
var parent = document.getElementById (cellIDX+"-"+cellIDY);
if (parent.getAttribute ("style") == "background-color: orange") {
  total = total - Math.round (Number(parent.getAttribute ("name")));
  parent.setAttribute ("style", "background-color: white");
} else {
  parent.setAttribute ("style", "background-color: orange");

  total = total + Math.round(Number(parent.getAttribute ("name")));
}
document.getElementById("total").innerHTML = gradeMap (total);
//total;
}

</script>


  </div>
  <script>
    var baseUrl = getQueryVariable("baseUrl")
    msGraphApiRoot = (baseUrl) ? baseUrl : "https://graph.microsoft.com/v1.0/me";

    var data = loadFromCookie();
    if (data)
    {
      if (!baseUrl)
        msGraphApiRoot = data.apiRoot;
      showCustomLoginButton(!data.signedin)
    }

    $(document).on({
      ajaxStart: function() {$('body').addClass('loading');},
      ajaxStop:  function() {$('body').removeClass('loading');}
    });

    function uploadItem (){
          var contentURL = msGraphApiRoot + "/drive/items/" + itemID + "/content";

          var assignmentData = Array(maxX+1);
          for (var i = 0; i <= maxX; i ++){
            assignmentData[i] = Array(maxY+1);
            for (var j = 0; j <= maxY; j ++){
              var parent = document.getElementById (i+"-"+j);
              if (parent != null) {
                if (parent.getAttribute ("style") == "background-color: orange") {
                  assignmentData[i][j] = 1;
                } else {
                  assignmentData[i][j] = 0;
                }
              }
            }
          }

          $.ajax({
            url: contentURL,
            dataType: 'json',
            type: 'put',
            headers: { "Authorization": "Bearer " + globalToken },
            data: JSON.stringify (assignmentData),
            success: function(data) {
              if (data) {
              }
            }
          });
    return (false);
    }

    function downloadItem (){
          var createAddDir = msGraphApiRoot + "/drive/root/children";
          var appDataID = "";

          var createFolder = { 
            "name": settingDir,
            "folder": { },
            "@microsoft.graph.conflictBehavior": "fail" // if it doesn't work it exists so don't worry (famous last words)
          };

          $.ajax({
            url: createAddDir,
            dataType: 'json',
            contentType: 'application/json',
            type: 'post',
            async: false,
            headers: { "Authorization": "Bearer " + globalToken },
            accept: "application/json;odata.metadata=none",
            data: JSON.stringify (createFolder)
          });


          var contentURL = msGraphApiRoot + "/drive/root:" + fileName; 
          $.ajax({
            url: contentURL,
            dataType: 'json',
            headers: { "Authorization": "Bearer " + globalToken },
            accept: "application/json;odata.metadata=none",
            success: function(data) {
              if (data) {
                itemID = data['id'];
                $('#od-value').val (data['@microsoft.graph.downloadUrl']);
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                  var assignmentData = JSON.parse (xhttp.responseText);
                  for (var i = 0; i <= maxX; i ++){
                    for (var j = 0; j <= maxY; j ++){
                      var isChecked = assignmentData[i][j];
                      if (isChecked == 1){
                        clicked (i, j);
                      }
                    }
                  }
                document.getElementById("od-title").innerHTML = pageTitle;
                saved = 1;
                }
                };
                xhttp.open("GET", data['@microsoft.graph.downloadUrl'], true);
                xhttp.send();
              }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
              // creating the setting file since it doesn't exist
            var contentURL = msGraphApiRoot + "/drive/root:" + fileName + ":/content";
            $.ajax({
              url: contentURL,
              dataType: 'json',
              contentType: 'text/plain',
              type: 'put',
              async: false,
              data: "[]",
              headers: { "Authorization": "Bearer " + globalToken },
              accept: "application/json;odata.metadata=none",
              success: function (data){
                if (data){
                  itemID = data['id'];
                }
              }
            });
              uploadItem ();
            }
          });
    return (false);
    }

    odauth();
  </script>



</body></html>
