<HTML>
<head>
  <link rel="stylesheet" type="text/css" href="https://martinbateman.github.io/labstyle.css"/>
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
  <script type="text/javascript" src="https://martinbateman.github.io/nanobar.min.js"></script>
  <script id="odauth" src="https://martinbateman.github.io/odauth.js"></script>
  <link rel="icon" href="https://d.sfx-df.ms/images/favicon.ico" type="image/x-icon">
  <link rel="mask-icon" href="https://d.sfx-df.ms/images/mask_icon.svg" color="#094AB2">



  <script>
    var moduleCode = "CO2516";
    var sessionNumber = "11";
    var sessionTitle = "HTTP";
    var fileName = "/" + settingDir + "/" + moduleCode + "-lab-" + sessionNumber + ".json"; 
    var pageTitle = moduleCode + " Lab " + sessionNumber + " - " + sessionTitle;
    document.title = pageTitle;
  </script>
</head>
<body>
 <div id="od-site">
    <div id="od-commands">
      <div id="od-login" style="display: hidden">
        <a href="#" onclick="signInToOneDrive()">Sign in to OneDrive</a>&nbsp;&nbsp;
      </div>
      <div id="od-logoff" style="display: hidden">
        <a href="#" onclick="signOut()">Sign Out</a>
      </div>
    </div>
    <div id="od-title"></div> <!-- this will get set later -->
  </div>

  <div id="od-loading"></div>
  <div id="od-content">
<ol id="instructions">

<div class="subtitle">Introduction</div>
<p>
In this lab you will install and configure IIS to serve dynamic content. IIS is a web server and you will configure
it to serve content that has been generated by a Python script, this is a similar idea to running dynamic content 
via php.
</p>
<p>

</p>
<div class="subtitle">Instructions</div>
<li>
If you do not already have a copy of Python on your Windows Server you should install it now.
</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<li>
From the Server Manager select IIS. When asked which Role Services to install select CGI.
</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<li>
From the Server Manager select IIS. When asked which Role Services to install select CGI.
</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<li>
Run the IIS Manager. 

</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<li>
Select the Default website. 
</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<li>
Double click on "Handler Mappings" in the center panel. 
</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<li>
Click "Add Script Map...". 

</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<li>
In the dialog set the following options

<table>
<tr>
  <td>Request path</td><td>*.py</td>
</tr>
<tr>
  <td>Executable</td><td>path to python then %s %s</td>
</tr>
<tr>
  <td>Name</td><td>Python</td>
</tr>
</table>
Note that the exact location of the python executable might have changed. You should use the browse option (...) to 
find the correct path.

</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<li>
Click on OK

</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<div class="subtitle">First Python CGI</div>

<li>
Put the following python script in c:\inetpub\wwwroot\first.py

<pre>
import cgi

form = cgi.FieldStorage ()

print ("Content-type: text/html")
print ("")
print ("<HTML><HEAD></HEAD>")
print ("<BODY>")
name = form.getvalue ('name')
if (name == None):
  print ("Hello World")
else:
  print ("Hello " + name)
print ("</BODY>")
print ("</HTML>")
</pre>
</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>


<li>
Start a web browser(You may want to download and install chrome rather than use IE.) on your Windows server and set the address 
to http://localhost/first.py. You should see a Hello World message. Change the URL to http://localhost/first.py?name=Fred and
the message should change to Hello Fred.

</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>


<li>
Change first.py so that it displays a form where you can enter your name. When you press submit it should say hello to you by name, for example
for me I'd enter Martin and it would say Hello Martin.

</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

<div class="subtitle">Instructions</div>

<li>
Combine this script with the Active Directory scripts you were given to create a simple phonebook application. The user should be able to
enter a name in a web page and the script looks up information about people matching that name in Active Directory. The script should return names,
email address and a telephone number.

</li>
<div class="collapsible" align="right">[help]</div>
<div class="content">
</div>

</ol>
  </div>
  <script type="text/javascript" src="https://martinbateman.github.io/labjs.js"></script>
<script>
(function () {
    var div = document.createElement("div");
    document.getElementsByTagName('body')[0].appendChild(div);
    div.outerHTML = "<div id='botDiv' style='height: 38px; position: fixed; bottom: 0; right:0 ; z-index: 1000; background-color: #fff'><div id='botTitleBar' style='height: 38px; width: 400px; position:fixed; cursor: pointer;'></div><iframe width='400px' height='600px' src='https://webchat.botframework.com/embed/MartinBotman?s=6SHQGsBTkGA.P4pqpBpbHEdoqhXVVmOhG3NyamC7p0XmlyIo-QFDbLE'></iframe></div>"; 

    document.querySelector('body').addEventListener('click', function (e) {
        e.target.matches = e.target.matches || e.target.msMatchesSelector;
        if (e.target.matches('#botTitleBar')) { 
            var botDiv = document.querySelector('#botDiv'); 
            botDiv.style.height = botDiv.style.height == '600px' ? '38px' : '600px';
        };
    });
}());
</script>
</body>
</html>

